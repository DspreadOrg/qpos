var READ_BUF_MAX_SIZE=1024*10;var dataBuffer=new ArrayBuffer(READ_BUF_MAX_SIZE);var dataView=new DataView(dataBuffer);var read_offset=0;function clearReadbuffer(){for(var a=0;a<read_offset;a++){dataView.setUint8(a,0)}read_offset=0}function appendData(b){var c=b;for(var a=0;a<c.byteLength;a++){dataView.setUint8(read_offset,c.getUint8(a));read_offset++}}function readBufferData(){var a=new ArrayBuffer(read_offset);var b=new DataView(a);console.log("read_offset:"+read_offset);copyArr(dataBuffer,0,a,0,read_offset);return b}function isCompleteInstruction(){var c=false;var a;console.log("isCompleteInstruction"+dataView.getUint8(0));if(dataView.getUint8(0)==77){var d=dataView.getUint8(1);var b=dataView.getUint8(2);a=(d-d%16)/16*Math.pow(16,3)+d%16*Math.pow(16,2)+b;console.log("isCompleteInstruction needRead:"+a);if(read_offset==a+4){c=true}}else{if(dataView.getUint8(0)==77){var d=dataView.getUint8(1);var b=dataView.getUint8(2);a=(d-d%16)/16*Math.pow(16,3)+d%16*Math.pow(16,2)+b;console.log("isCompleteInstruction needRead:"+a);if(read_offset==a+4){c=true}}}return c};